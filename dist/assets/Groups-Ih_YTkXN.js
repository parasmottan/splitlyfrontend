import{r as d,j as e,u as C,a as N}from"./index-D9jaU1zW.js";import{b as k,c as y,d as z,e as O,f as A,a as R,g as W,h as B,i as D}from"./index-CSbZRpxs.js";import{u as E}from"./groupStore-C3tD8i92.js";import{A as S}from"./Avatar-DYljWgBQ.js";import{B as G}from"./BottomNav-B9-9UmQT.js";import{u as I}from"./notificationStore-ZqLwDpt1.js";import{S as h}from"./Skeleton-BoBXcNGr.js";import"./index-B2owPRhH.js";function T({isOpen:i,onClose:s}){const{notifications:r,fetchNotifications:x,markAsRead:c,markAllRead:n,loading:l}=I();d.useEffect(()=>{i&&x()},[i]);const p=t=>{switch(t){case"reminder":return e.jsx(A,{style:{color:"var(--blue)"}});case"invite":return e.jsx(O,{style:{color:"var(--green)"}});default:return e.jsx(y,{style:{color:"var(--gray-500)"}})}};return i?e.jsxs("div",{style:{position:"fixed",inset:0,zIndex:1e3,display:"flex",justifyContent:"flex-end"},children:[e.jsx("div",{onClick:s,style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.3)",backdropFilter:"blur(2px)"}}),e.jsxs("div",{style:{position:"relative",width:"85%",maxWidth:"360px",height:"100%",background:"white",boxShadow:"-4px 0 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",animation:"slideInRight 0.3s ease-out"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"700"},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:n,style:{fontSize:"13px",color:"var(--blue)",fontWeight:"600",background:"none",border:"none"},children:"Mark all read"}),e.jsx(k,{onClick:s,style:{fontSize:"28px",cursor:"pointer"}})]})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:[l&&e.jsx("div",{className:"loading-center",children:e.jsx("div",{className:"spinner"})}),!l&&r.length===0&&e.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"var(--text-secondary)"},children:[e.jsx(y,{style:{fontSize:"48px",marginBottom:"16px",opacity:.3}}),e.jsx("p",{children:"No notifications yet"})]}),r.map(t=>e.jsxs("div",{onClick:()=>c(t._id),style:{padding:"16px",borderRadius:"16px",background:t.isRead?"transparent":"var(--blue-light)",marginBottom:"8px",display:"flex",gap:"12px",cursor:"pointer",transition:"background 0.2s"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",flexShrink:0,boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:p(t.type)}),e.jsxs("div",{style:{flex:1},children:[e.jsx("p",{style:{fontSize:"14px",color:"var(--text-primary)",lineHeight:"1.4",marginBottom:"4px"},children:t.message}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"12px",color:"var(--text-secondary)"},children:[e.jsx(z,{}),e.jsx("span",{children:new Date(t.createdAt).toLocaleDateString()})]})]}),!t.isRead&&e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--blue)",marginTop:"6px"}})]},t._id))]})]}),e.jsx("style",{children:`
        @keyframes slideInRight {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]}):null}function Y({title:i,onBack:s,rightAction:r}){const[x,c]=d.useState(!1),{unreadCount:n,fetchNotifications:l}=I();return d.useEffect(()=>{l()},[]),e.jsxs("div",{className:"glass-header",style:{padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:100,minHeight:"44px"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",minWidth:"60px",zIndex:1},children:s&&e.jsxs("button",{className:"header-back",onClick:s,style:{padding:0},children:[e.jsx(R,{style:{fontSize:"20px"}}),e.jsx("span",{children:"Back"})]})}),i&&e.jsx("h1",{className:"title-large",style:{margin:0,position:s?"absolute":"relative",left:s?"50%":"auto",transform:s?"translateX(-50%)":"none",fontSize:s?"17px":"34px",fontWeight:s?"600":"700",letterSpacing:s?"0":"-0.4px",maxWidth:s?"60%":"none",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:i}),e.jsx("div",{style:{minWidth:"44px",display:"flex",justifyContent:"flex-end",zIndex:1},children:r||e.jsxs("div",{onClick:()=>c(!0),style:{position:"relative",width:"36px",height:"36px",borderRadius:"50%",background:"var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:[e.jsx(y,{style:{fontSize:"20px",color:"var(--text-primary)"}}),n>0&&e.jsx("div",{style:{position:"absolute",top:"6px",right:"6px",width:"8px",height:"8px",borderRadius:"50%",background:"var(--red)",border:"2px solid white"}})]})}),e.jsx(T,{isOpen:x,onClose:()=>c(!1)})]})}const _=d.memo(Y);function q(){const i=C(),{groups:s,loading:r,fetchGroups:x}=E(),{user:c}=N();d.useEffect(()=>{x()},[]);const n=s.filter(t=>!t.archived),l=s.filter(t=>t.archived),p=d.useCallback(t=>{i(`/groups/${t}`)},[i]);return e.jsxs("div",{className:"page page-white",style:{position:"relative",display:"flex",flexDirection:"column"},children:[e.jsx(_,{title:"Your Groups"}),e.jsxs("div",{style:{padding:"0 20px",flex:1,overflowY:"auto",paddingBottom:"100px"},children:[e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",margin:"8px 0 24px"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(W,{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-secondary)",fontSize:"18px"}}),e.jsx("input",{type:"text",placeholder:"Search groups...",style:{width:"100%",padding:"12px 12px 12px 40px",borderRadius:"12px",border:"1px solid var(--gray-200)",background:"var(--gray-50)",outline:"none",fontSize:"17px",transition:"border-color 200ms ease, box-shadow 200ms ease"}})]}),e.jsx("button",{onClick:()=>i("/get-started"),style:{width:"44px",height:"44px",background:"var(--blue)",color:"white",borderRadius:"12px",border:"none",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",cursor:"pointer",flexShrink:0,transition:"transform 120ms ease-out"},children:e.jsx(B,{})})]}),n.length>0&&e.jsx("div",{className:"card",style:{marginBottom:"24px",padding:"20px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"13px",color:"var(--text-secondary)",fontWeight:"500",marginBottom:"4px"},children:"You owe"}),e.jsxs("p",{style:{fontSize:"24px",fontWeight:"700",color:"var(--red)"},children:["₹",n.reduce((t,o)=>{var a;return t+(((a=o.balance)==null?void 0:a.youOwe)||0)},0).toFixed(2)]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{fontSize:"13px",color:"var(--text-secondary)",fontWeight:"500",marginBottom:"4px"},children:"You're owed"}),e.jsxs("p",{style:{fontSize:"24px",fontWeight:"700",color:"var(--green)"},children:["₹",n.reduce((t,o)=>{var a;return t+(((a=o.balance)==null?void 0:a.youAreOwed)||0)},0).toFixed(2)]})]})]})}),r&&n.length===0&&e.jsx("div",{style:{marginTop:"12px"},children:[1,2,3].map(t=>e.jsx("div",{className:"card",style:{marginBottom:"12px",padding:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(h,{width:"44px",height:"44px",borderRadius:"50%"}),e.jsxs("div",{style:{flex:1},children:[e.jsx(h,{width:"60%",height:"18px",style:{marginBottom:"8px"}}),e.jsx(h,{width:"40%",height:"13px"})]})]})},t))}),!r&&n.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsx(D,{style:{fontSize:"32px"}})}),e.jsx("h3",{className:"empty-state-title",children:"No groups yet"}),e.jsx("p",{className:"empty-state-text",children:"Create a group to start splitting expenses."}),e.jsx("button",{className:"btn-primary",style:{maxWidth:"240px"},onClick:()=>i("/get-started"),children:"Create Group"})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"caption",style:{marginBottom:"12px"},children:"ACTIVE"}),n.map(t=>{var o,a,f,m,g,u,j,v,b,w;return e.jsx("div",{className:"card animate-fade-in",style:{marginBottom:"12px",padding:"16px",cursor:"pointer"},onClick:()=>p(t._id),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(S,{name:t.name}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h4",{style:{fontSize:"17px",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),((o=t.balance)==null?void 0:o.isSettled)&&e.jsx("span",{className:"badge badge-green",style:{fontSize:"11px",marginLeft:"8px",flexShrink:0},children:"SETTLED"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"4px"},children:[e.jsxs("span",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:[((a=t.members)==null?void 0:a.length)||0," member",(((f=t.members)==null?void 0:f.length)||0)!==1?"s":""]}),e.jsxs("span",{style:{fontSize:"15px",fontWeight:"600",color:((m=t.balance)==null?void 0:m.youOwe)>0?"var(--red)":((g=t.balance)==null?void 0:g.youAreOwed)>0?"var(--green)":"var(--text-secondary)"},children:[((u=t.balance)==null?void 0:u.youOwe)>0&&`You owe ₹${t.balance.youOwe.toFixed(0)}`,((j=t.balance)==null?void 0:j.youAreOwed)>0&&`You are owed ₹${t.balance.youAreOwed.toFixed(0)}`,!((v=t.balance)!=null&&v.youOwe)&&!((b=t.balance)!=null&&b.youAreOwed)&&!((w=t.balance)!=null&&w.isSettled)&&"No expenses"]})]})]})]})},t._id)})]}),l.length>0&&e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx("h3",{className:"caption",style:{marginBottom:"12px"},children:"ARCHIVED"}),l.map(t=>e.jsx("div",{className:"card",style:{marginBottom:"12px",padding:"16px",opacity:.6,cursor:"pointer"},onClick:()=>p(t._id),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(S,{name:t.name}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{fontSize:"17px",fontWeight:"600"},children:t.name}),e.jsx("span",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:"Archived"})]})]})},t._id))]})]}),e.jsx(G,{})]})}export{q as default};
