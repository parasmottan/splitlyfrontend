import{d as y,u as j,a as b,r as i,j as e}from"./index-DPogj0TL.js";import{a as I,l as N}from"./index-DNGD5F6U.js";import{i as p}from"./inviteService-86050shq.js";function C(){const{token:r}=y(),s=j(),{user:m}=b(),[u,g]=i.useState(null),[h,f]=i.useState(!0),[l,c]=i.useState(!1),[d,x]=i.useState(null);i.useEffect(()=>{(async()=>{var n,t;try{const o=await p.verifyToken(r);g(o)}catch(o){x(((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.message)||"Invalid or expired invite link")}finally{f(!1)}})()},[r]);const v=async()=>{var a,n;if(!m){s("/login",{state:{from:`/join/${r}`}});return}c(!0);try{const t=await p.acceptInvite(r);s(`/groups/${t.groupId}`)}catch(t){x(((n=(a=t.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to join group")}finally{c(!1)}};return h?e.jsx("div",{className:"loading-center",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{className:"page page-white",style:{display:"flex",flexDirection:"column",padding:"0 20px",minHeight:"100dvh"},children:[e.jsx("div",{className:"header",children:e.jsxs("button",{className:"header-back",onClick:()=>s("/groups"),children:[e.jsx(I,{style:{fontSize:"20px"}})," Groups"]})}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"var(--blue-light)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"32px"},children:e.jsx(N,{style:{fontSize:"32px",color:"var(--blue)"}})}),d?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"title-large",style:{color:"var(--red)",marginBottom:"12px"},children:"Invite Error"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"48px",fontSize:"17px"},children:d}),e.jsx("button",{className:"btn-primary",onClick:()=>s("/groups"),style:{maxWidth:"300px"},children:"Go to My Groups"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"title-large",style:{marginBottom:"12px"},children:"Group Invite"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"8px",fontSize:"17px"},children:"You've been invited to join"}),e.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",color:"var(--blue)",marginBottom:"48px"},children:u.groupName}),e.jsxs("div",{style:{width:"100%",maxWidth:"300px"},children:[e.jsx("button",{className:"btn-primary",onClick:v,disabled:l,style:{marginBottom:"16px"},children:l?"Joining...":"Accept & Join Group"}),e.jsx("button",{className:"btn-secondary",onClick:()=>s("/groups"),children:"Decline"})]})]})]})]})}export{C as default};
