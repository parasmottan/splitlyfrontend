import{c as n,d as c}from"./index-DNKDXbwY.js";const d=n((p,i)=>({groups:[],activeGroup:null,loading:!1,error:null,fetchGroups:async()=>{var o,u;try{p({loading:!0,error:null});const{data:a}=await c.get("/groups");p({groups:a,loading:!1})}catch(a){p({error:((u=(o=a.response)==null?void 0:o.data)==null?void 0:u.message)||"Failed to fetch groups",loading:!1})}},fetchGroup:async o=>{var u,a;try{p({loading:!0,error:null});const{data:r}=await c.get(`/groups/${o}`);return p({activeGroup:r,loading:!1}),r}catch(r){throw p({error:((a=(u=r.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to fetch group",loading:!1}),r}},createGroup:async o=>{var u,a;try{p({loading:!0,error:null});const{data:r}=await c.post("/groups",o);return p(e=>({groups:[r,...e.groups],loading:!1})),r}catch(r){const e=((a=(u=r.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to create group";throw p({error:e,loading:!1}),new Error(e)}},joinGroup:async o=>{var u,a;try{p({loading:!0,error:null});const{data:r}=await c.post("/groups/join",{inviteCode:o});return p(e=>({groups:[r,...e.groups],loading:!1})),r}catch(r){const e=((a=(u=r.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to join group";throw p({error:e,loading:!1}),new Error(e)}},updateGroup:async(o,u)=>{var a,r;try{const{data:e}=await c.put(`/groups/${o}`,u);return p(t=>{var l;return{groups:t.groups.map(s=>s._id===o?{...s,...e}:s),activeGroup:((l=t.activeGroup)==null?void 0:l._id)===o?{...t.activeGroup,...e}:t.activeGroup}}),e}catch(e){throw new Error(((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to update group")}},archiveGroup:async o=>{var u,a;try{await c.put(`/groups/${o}/archive`),p(r=>{var e;return{groups:r.groups.map(t=>t._id===o?{...t,archived:!0}:t),activeGroup:((e=r.activeGroup)==null?void 0:e._id)===o?{...r.activeGroup,archived:!0}:r.activeGroup}})}catch(r){throw new Error(((a=(u=r.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to archive group")}},deleteGroup:async o=>{var u,a;try{await c.delete(`/groups/${o}`),p(r=>{var e;return{groups:r.groups.filter(t=>t._id!==o),activeGroup:((e=r.activeGroup)==null?void 0:e._id)===o?null:r.activeGroup}})}catch(r){throw new Error(((a=(u=r.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to delete group")}},leaveGroup:async o=>{var u,a;try{await c.put(`/groups/${o}/leave`),p(r=>{var e;return{groups:r.groups.filter(t=>t._id!==o),activeGroup:((e=r.activeGroup)==null?void 0:e._id)===o?null:r.activeGroup}})}catch(r){throw new Error(((a=(u=r.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to leave group")}},clearActiveGroup:()=>p({activeGroup:null}),clearError:()=>p({error:null})}));export{d as u};
