import{b as P,u as W,a as O,r,j as e}from"./index-D9jaU1zW.js";import{a as R,e as Y}from"./index-CSbZRpxs.js";import{c as F}from"./index-B2owPRhH.js";import{u as H}from"./groupStore-C3tD8i92.js";import{i as c}from"./inviteService-x3M9E9sC.js";import{A as C}from"./Avatar-DYljWgBQ.js";import{M as I}from"./Modal-U1dt2-8j.js";function X(){var v,y,f,j,b,N;const{id:n}=P(),l=W(),{activeGroup:o,fetchGroup:u,archiveGroup:k,deleteGroup:B,leaveGroup:z}=H(),{user:i}=O(),[D,d]=r.useState(!1),[G,p]=r.useState(!1),[E,g]=r.useState(!1),[m,x]=r.useState([]);if(r.useEffect(()=>{(!o||o._id!==n)&&u(n),(async()=>{try{const a=await c.getPendingInvites(n);x(a)}catch{}})()},[n]),!o)return e.jsx("div",{className:"page",children:e.jsx("div",{className:"loading-center",children:e.jsx("div",{className:"spinner"})})});const t=o,h=((v=t.owner)==null?void 0:v._id)===(i==null?void 0:i._id),A=async()=>{try{await navigator.clipboard.writeText(t.inviteCode),g(!0),setTimeout(()=>g(!1),2e3)}catch{}},M=async()=>{try{await k(n),l("/groups",{replace:!0})}catch{}},_=async()=>{try{await B(n),l("/groups",{replace:!0})}catch{}},L=async()=>{try{await z(n),l("/groups",{replace:!0})}catch{}};return e.jsxs("div",{className:"page page-white",style:{padding:"0 20px"},children:[e.jsxs("div",{className:"header",children:[e.jsxs("button",{className:"header-back",onClick:()=>l(-1),children:[e.jsx(R,{style:{fontSize:"20px"}})," Back"]}),e.jsx("span",{className:"header-title",children:"Group Settings"}),e.jsx("div",{style:{width:"60px"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px 0 32px"},children:[e.jsx(C,{name:t.name,size:"xl"}),e.jsx("h2",{style:{fontSize:"22px",fontWeight:"700",marginTop:"12px"},children:t.name}),e.jsxs("p",{style:{fontSize:"15px",color:"var(--text-secondary)"},children:[((y=t.type)==null?void 0:y.charAt(0).toUpperCase())+((f=t.type)==null?void 0:f.slice(1))," Â· ",(j=t.members)==null?void 0:j.length," member",((b=t.members)==null?void 0:b.length)!==1?"s":""]})]}),e.jsx("div",{className:"card",style:{padding:"20px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"13px",color:"var(--text-secondary)",fontWeight:"500",marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Invite Code"}),e.jsx("p",{style:{fontSize:"24px",fontWeight:"700",letterSpacing:"4px"},children:t.inviteCode})]}),e.jsxs("button",{onClick:A,style:{padding:"10px 16px",background:"var(--blue-light)",borderRadius:"14px",color:"var(--blue)",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"transform 120ms ease-out"},children:[e.jsx(F,{}),E?"Copied!":"Copy"]})]})}),e.jsxs("div",{className:"card",style:{padding:"0 16px",marginBottom:"16px"},children:[e.jsxs("div",{className:"form-row",children:[e.jsx("span",{className:"form-row-label",children:"Currency"}),e.jsxs("span",{className:"form-row-value",children:[t.currency," (",t.currencySymbol,")"]})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("span",{className:"form-row-label",children:"Created"}),e.jsx("span",{className:"form-row-value",children:new Date(t.createdAt).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})]})]}),e.jsx("h3",{className:"caption",style:{marginBottom:"12px"},children:"MEMBERS"}),e.jsx("div",{className:"card",style:{padding:"0 16px",marginBottom:"24px"},children:(N=t.members)==null?void 0:N.map(s=>{const a=s.user;return e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(C,{name:a.name,size:"sm"}),e.jsxs("div",{children:[e.jsx("p",{style:{fontWeight:"500",fontSize:"17px"},children:a._id===(i==null?void 0:i._id)?"You":a.name}),e.jsx("p",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:a.email})]})]}),s.role==="owner"&&e.jsx("span",{className:"badge badge-blue",style:{fontSize:"11px"},children:"Owner"})]},a._id)})}),e.jsx("h3",{className:"caption",style:{marginBottom:"12px"},children:"INVITE BY EMAIL"}),e.jsxs("div",{className:"card",style:{padding:"20px",marginBottom:"24px"},children:[e.jsx("p",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"16px",lineHeight:"1.4"},children:"Add members by entering their email addresses. If they don't have an account, they'll receive an invite link."}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{type:"email",placeholder:"friend@example.com",id:"invite-email-input",className:"form-input",style:{flex:1}}),e.jsx("button",{onClick:async()=>{var w,S;const s=document.getElementById("invite-email-input"),a=s.value.trim();if(a&&/^\S+@\S+\.\S+$/.test(a))try{await c.sendInvites(n,[a]),s.value="",u(n),x(await c.getPendingInvites(n))}catch(T){alert(((S=(w=T.response)==null?void 0:w.data)==null?void 0:S.message)||"Failed to send invite")}},className:"btn-primary",style:{width:"auto",padding:"0 20px",marginBottom:0},children:"Invite"})]})]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"caption",style:{marginBottom:"12px"},children:"PENDING INVITES"}),e.jsx("div",{className:"card",style:{padding:"0 16px",marginBottom:"32px"},children:m.map(s=>e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Y,{style:{fontSize:"16px",color:"var(--text-secondary)"}})}),e.jsxs("div",{children:[e.jsx("p",{style:{fontWeight:"500",fontSize:"15px"},children:s.invitedEmail}),e.jsxs("p",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:["Expires: ",new Date(s.expiresAt).toLocaleDateString()]})]})]}),e.jsx("button",{onClick:async()=>{window.confirm("Cancel this invite?")&&(await c.cancelInvite(s._id),x(m.filter(a=>a._id!==s._id)))},style:{color:"var(--red)",fontSize:"14px",border:"none",background:"none",fontWeight:"600",cursor:"pointer"},children:"Cancel"})]},s._id))})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",paddingBottom:"40px"},children:[h&&!t.archived&&e.jsx("button",{className:"btn-secondary",onClick:M,style:{color:"var(--orange)"},children:"Archive Group"}),h&&e.jsx("button",{className:"btn-danger",onClick:()=>d(!0),children:"Delete Group"}),!h&&e.jsx("button",{className:"btn-danger",onClick:()=>p(!0),children:"Leave Group"})]}),e.jsxs(I,{show:D,title:"Delete Group?",message:"This will permanently delete the group and all expenses. This action cannot be undone.",onClose:()=>d(!1),variant:"alert",children:[e.jsx("div",{className:"modal-divider"}),e.jsxs("div",{className:"modal-actions-row",children:[e.jsx("button",{onClick:()=>d(!1),children:"Cancel"}),e.jsx("button",{className:"modal-btn-danger",onClick:_,children:"Delete"})]})]}),e.jsxs(I,{show:G,title:"Leave Group?",message:"You'll lose access to this group and its expenses. You can join again with the invite code.",onClose:()=>p(!1),variant:"alert",children:[e.jsx("div",{className:"modal-divider"}),e.jsxs("div",{className:"modal-actions-row",children:[e.jsx("button",{onClick:()=>p(!1),children:"Cancel"}),e.jsx("button",{className:"modal-btn-danger",onClick:L,children:"Leave"})]})]})]})}export{X as default};
